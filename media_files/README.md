# Media Files Management Module

–ú–æ–¥—É–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞–º–∏ –¥–ª—è OK Tools —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–∏—Å–∫–æ–º, —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–º —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π.

> **üìñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ NAS —Ö—Ä–∞–Ω–∏–ª–∏—â–∞**: –°–º. [NAS_SETUP.md](./NAS_SETUP.md) –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è —Å–µ—Ç–µ–≤—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â SMB/CIFS.

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìÅ **–ì–∏–±–∫–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –º–µ—Å—Ç–∞–º–∏ —Ö—Ä–∞–Ω–µ–Ω–∏—è (–∞—Ä—Ö–∏–≤, playout, custom)
- üîç **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ü–æ–∏—Å–∫ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤ –ø–æ –Ω–æ–º–µ—Ä—É –≤ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞
- üìä **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ**: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ —á–µ—Ä–µ–∑ ffprobe
  - –í–∏–¥–µ–æ: –∫–æ–¥–µ–∫, –±–∏—Ç—Ä–µ–π—Ç, FPS, —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ, —Ü–≤–µ—Ç–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, chroma subsampling
  - –ê—É–¥–∏–æ: –∫–æ–¥–µ–∫, –±–∏—Ç—Ä–µ–π—Ç, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤, sample rate
- üé¨ **–ü—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ø–ª–µ–µ—Ä –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- üîÑ **–ê–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ –∞—Ä—Ö–∏–≤–∞ –≤ playout –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏ —ç—Ñ–∏—Ä–∞
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏**: Checksum –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Ñ–∞–π–ª–æ–≤
- üìù **–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π**: –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å —Ñ–∞–π–ª–∞–º–∏

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
- **ffmpeg/ffprobe**: –î–ª—è –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
  ```bash
  # Ubuntu/Debian
  sudo apt-get install ffmpeg
  
  # macOS
  brew install ffmpeg
  ```

### 2. –ú–∏–≥—Ä–∞—Ü–∏–∏

```bash
python manage.py migrate media_files
```

### 3. –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ config —Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, `docker.cfg`):

```ini
[media]
# Archive path - where video files are stored long-term
archive_path = /mnt/archive/

# Playout path - where video files are copied for broadcasting
playout_path = /mnt/playout/library/

# Auto-scan storage locations for new files
auto_scan = False

# Auto-copy videos to playout when broadcast plan is saved
auto_copy_on_schedule = True
```

### 4. –°–æ–∑–¥–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â

–ß–µ—Ä–µ–∑ Django Admin —Å–æ–∑–¥–∞–π—Ç–µ `StorageLocation`:

1. **Archive** (storage_type=ARCHIVE):
   - Name: "Video Archive"
   - Path: `/mnt/archive/`
   - Is Active: ‚úì
   - Scan Enabled: ‚úì

2. **Playout** (storage_type=PLAYOUT):
   - Name: "Playout Library"
   - Path: `/mnt/playout/library/`
   - Is Active: ‚úì

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### Management –∫–æ–º–∞–Ω–¥—ã

#### 1. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

```bash
# –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
python manage.py scan_video_storage --storage-id 1

# –°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
python manage.py scan_video_storage --all

# –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö
python manage.py scan_video_storage --all --force --update-metadata

# –° —Ä–∞—Å—á–µ—Ç–æ–º checksum (–º–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤)
python manage.py scan_video_storage --all --calculate-checksum
```

#### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

```bash
# –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –≤–∏–¥–µ–æ
python manage.py update_video_metadata --number 12345

# –û–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –≤–∏–¥–µ–æ
python manage.py update_video_metadata --all

# –û–±–Ω–æ–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–∞–π–ª—ã —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏
python manage.py update_video_metadata --all --missing-only

# –° –ø–µ—Ä–µ—Å—á–µ—Ç–æ–º checksum
python manage.py update_video_metadata --all --calculate-checksum
```

#### 3. –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ playout

```bash
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –≤–∏–¥–µ–æ
python manage.py copy_to_playout --number 12345 17890

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–∏–¥–µ–æ –∏–∑ –ø–ª–∞–Ω–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –¥–∞—Ç—ã
python manage.py copy_to_playout --date 2025-10-15

# –í –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
python manage.py copy_to_playout --number 12345 --destination-id 2

# –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ
python manage.py copy_to_playout --date 2025-10-15 --skip-existing
```

#### 4. –û—á–∏—Å—Ç–∫–∞ playout

```bash
# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã —Å—Ç–∞—Ä—à–µ 7 –¥–Ω–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
python manage.py cleanup_playout

# –£–¥–∞–ª–∏—Ç—å —Ñ–∞–π–ª—ã —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
python manage.py cleanup_playout --days-old 30

# –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è
python manage.py cleanup_playout --dry-run

# –û—Å—Ç–∞–≤–∏—Ç—å –∑–∞–ø–∏—Å–∏ –≤ –ë–î, —É–¥–∞–ª–∏—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–∏–∑–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã
python manage.py cleanup_playout --keep-in-database
```

### –†–∞–±–æ—Ç–∞ —á–µ—Ä–µ–∑ Django Admin

> **üìñ –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Django Admin**: –°–º. [ADMIN_GUIDE.md](./ADMIN_GUIDE.md) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π —Å–æ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞–º–∏.

#### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞

1. –û—Ç–∫—Ä–æ–π –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å: `http://localhost:8000/admin/`
2. –ü–µ—Ä–µ–π–¥–∏: **Media Files ‚Üí Storage locations ‚Üí Add**
3. –ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É:
   ```
   Name: NAS Archive
   Type: ARCHIVE
   Path: /mnt/nas/archive/
   Description: –ê—Ä—Ö–∏–≤ –Ω–∞ NAS 192.168.XXX.XXX
   Is active: ‚òë
   ```
4. –°–æ—Ö—Ä–∞–Ω–∏
5. –ó–∞–ø—É—Å—Ç–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:
   ```bash
   python manage.py scan_video_storage
   ```

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞–º–∏ (StorageLocation)

- **–î–µ–π—Å—Ç–≤–∏—è**:
  - "Scan now" - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—ã–±—Ä–∞–Ω–Ω—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â
  - "Test connection" - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—É—Ç–µ–π

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞–º–∏ (VideoFile)

- **–ü–æ–∏—Å–∫**: –ü–æ –Ω–æ–º–µ—Ä—É, –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞, –∫–æ–¥–µ–∫–∞–º
- **–§–∏–ª—å—Ç—Ä—ã**: –ü–æ —Ö—Ä–∞–Ω–∏–ª–∏—â—É, —Ñ–æ—Ä–º–∞—Ç—É, –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏, –¥–∞—Ç–µ —Å–æ–∑–¥–∞–Ω–∏—è
- **–î–µ–π—Å—Ç–≤–∏—è**:
  - "Copy to playout storage" - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ playout
  - "Update metadata" - –û–±–Ω–æ–≤–∏—Ç—å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
  - "Verify file integrity" - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å checksum
- **–ü—Ä–æ—Å–º–æ—Ç—Ä –≤–∏–¥–µ–æ**: –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π HTML5 –ø–ª–µ–µ—Ä —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π seeking

### API –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

#### –ê–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

–ü—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–ª–∞–Ω–∞ —Ç—Ä–∞–Ω—Å–ª—è—Ü–∏–π (–Ω–µ —á–µ—Ä–Ω–æ–≤–∏–∫–∞) –≤ –º–æ–¥—É–ª–µ `planung`, –≤–∏–¥–µ–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–ø–∏—Ä—É—é—Ç—Å—è –∏–∑ –∞—Ä—Ö–∏–≤–∞ –≤ playout:

```python
# –≠—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ planung/views.py
# –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ TagesPlan —Å draft=False
```

#### –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from media_files.models import VideoFile, StorageLocation
from media_files.tasks import copy_video_to_playout

# –ù–∞–π—Ç–∏ –≤–∏–¥–µ–æ
video = VideoFile.objects.get(number=12345)

# –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤ playout
success, message = copy_video_to_playout(video)

# –ü–æ–ª—É—á–∏—Ç—å –≤–∏–¥–µ–æ –¥–ª—è License
from licenses.models import License
license = License.objects.get(number=12345)
video_file = license.get_video_file()
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

### –°–æ–≥–ª–∞—à–µ–Ω–∏—è –æ–± –∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏

–í–∏–¥–µ–æ—Ñ–∞–π–ª—ã –¥–æ–ª–∂–Ω—ã —Å–ª–µ–¥–æ–≤–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç—É:
```
<number>_<–Ω–∞–∑–≤–∞–Ω–∏–µ>.<—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ>
```

–ü—Ä–∏–º–µ—Ä—ã:
- `12345_–º–æ—ë_–≤–∏–¥–µ–æ.mp4`
- `17890_—Ä–µ–ø–æ—Ä—Ç–∞–∂_2025.mov`
- `99999_–∏–Ω—Ç–µ—Ä–≤—å—é.mpg`

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `mp4`, `mov`, `mpeg`, `mpg`

–ú–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤ `settings.py`:
```python
VIDEO_SUPPORTED_FORMATS = ['mp4', 'mov', 'mpeg', 'mpg', 'avi', 'mkv']
```

## –ú–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ –≤–∏–¥–µ–æ

–ú–æ–¥—É–ª—å –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∏ —Ö—Ä–∞–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ:

### –û–±—â–∏–µ
- –§–æ—Ä–º–∞—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞
- –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –û–±—â–∏–π –±–∏—Ç—Ä–µ–π—Ç
- Checksum (SHA256)

### –í–∏–¥–µ–æ
- –ö–æ–¥–µ–∫ (–∫–æ—Ä–æ—Ç–∫–æ–µ –∏ –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)
- –ü—Ä–æ—Ñ–∏–ª—å –∫–æ–¥–µ–∫–∞
- –ë–∏—Ç—Ä–µ–π—Ç
- FPS (—á–∞—Å—Ç–æ—Ç–∞ –∫–∞–¥—Ä–æ–≤)
- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ (—à–∏—Ä–∏–Ω–∞ x –≤—ã—Å–æ—Ç–∞)
- –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω
- –§–æ—Ä–º–∞—Ç –ø–∏–∫—Å–µ–ª–µ–π (pixel format)
- –¶–≤–µ—Ç–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ (bt709, bt2020, etc.)
- –î–∏–∞–ø–∞–∑–æ–Ω —Ü–≤–µ—Ç–∞ (tv, pc)
- Chroma subsampling (4:2:0, 4:2:2, 4:4:4)

### –ê—É–¥–∏–æ
- –ö–æ–¥–µ–∫ (–∫–æ—Ä–æ—Ç–∫–æ–µ –∏ –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ)
- –ë–∏—Ç—Ä–µ–π—Ç
- Sample rate
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–∞–Ω–∞–ª–æ–≤
- Channel layout (stereo, 5.1, mono, etc.)

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –ú–æ–¥–µ–ª–∏

#### StorageLocation
–ú–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤ (–∞—Ä—Ö–∏–≤, playout, custom).

#### VideoFile
–ó–∞–ø–∏—Å—å –æ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–µ —Å –ø–æ–ª–Ω—ã–º–∏ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏.

#### FileOperation
–ò—Å—Ç–æ—Ä–∏—è –æ–ø–µ—Ä–∞—Ü–∏–π —Å —Ñ–∞–π–ª–∞–º–∏ (—Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ, –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∏–µ).

### –£—Ç–∏–ª–∏—Ç—ã (utils.py)

- `extract_number_from_filename()` - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –Ω–æ–º–µ—Ä–∞ –∏–∑ –∏–º–µ–Ω–∏
- `scan_directory()` - –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞–ø–∫–∏
- `extract_video_metadata()` - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ ffprobe
- `calculate_checksum()` - –†–∞—Å—á–µ—Ç SHA256
- `copy_file_with_progress()` - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
- `verify_file_integrity()` - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏

### Tasks (tasks.py)

- `copy_videos_for_plan()` - –ê–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø–ª–∞–Ω–∞ —ç—Ñ–∏—Ä–∞
- `copy_video_to_playout()` - –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ

## Troubleshooting

### –í–∏–¥–µ–æ –Ω–µ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –ø—Ä–∏ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–∏

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–æ—Ä–º–∞—Ç –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞: `<—á–∏—Å–ª–æ>_–Ω–∞–∑–≤–∞–Ω–∏–µ.—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –≤ `VIDEO_SUPPORTED_FORMATS`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø—É—Ç–∏ –≤ StorageLocation

### –û—à–∏–±–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω ffmpeg/ffprobe:
   ```bash
   ffprobe -version
   ```
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª–∞–º
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω

### –í–∏–¥–µ–æ –Ω–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—Å—è –≤ –∞–¥–º–∏–Ω–∫–µ

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–¥–µ—Ä–∂–∫—É —Ñ–æ—Ä–º–∞—Ç–∞ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `is_available = True`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—É—Ç—å –∫ —Ñ–∞–π–ª—É

### –ê–≤—Ç–æ–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫—É `VIDEO_AUTO_COPY_ON_SCHEDULE = True`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–ª–∞–Ω —Å–æ—Ö—Ä–∞–Ω–µ–Ω —Å `draft=False`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `ok_tools-debug.log`

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `FileOperation`
- Checksum –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ø—Ä–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏
- –§–∏–∑–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –∑–∞–ø–∏—Å–∏ –∏–∑ –ë–î (—Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ cleanup –∫–æ–º–∞–Ω–¥—É)
- –¢–æ–ª—å–∫–æ staff –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏–º–µ—é—Ç –¥–æ—Å—Ç—É–ø –∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—é

## Performance

- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--calculate-checksum` —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ (–º–µ–¥–ª–µ–Ω–Ω–æ –¥–ª—è –±–æ–ª—å—à–∏—Ö —Ñ–∞–π–ª–æ–≤)
- –ü—Ä–∏ –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–∞—Ö –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–æ–Ω–µ
- –†–µ–≥—É–ª—è—Ä–Ω–æ –æ—á–∏—â–∞–π—Ç–µ playout –æ—Ç —Å—Ç–∞—Ä—ã—Ö —Ñ–∞–π–ª–æ–≤

## –õ–∏—Ü–µ–Ω–∑–∏—è

–ß–∞—Å—Ç—å –ø—Ä–æ–µ–∫—Ç–∞ OK Tools.

## –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–î–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤ –∏ –ø—Ä–æ–±–ª–µ–º —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ –ø—Ä–æ–µ–∫—Ç–∞.

