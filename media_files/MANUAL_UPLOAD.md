# –†—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–≤

## –î–≤–∞ —Å–ø–æ—Å–æ–±–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ –≤—Ä—É—á–Ω—É—é:

### –°–ø–æ—Å–æ–± 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

1. **–û—Ç–∫—Ä–æ–π**: http://localhost:8000/admin/media_files/videofile/add/

2. **–í—ã–±–µ—Ä–∏ Storage Location** –∏–∑ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞:
   ```
   Storage location: [NAS Archive ‚ñº]
   ```

3. **–ó–∞–≥—Ä—É–∑–∏ —Ñ–∞–π–ª**:
   ```
   Upload Video File: [–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª]
   ```
   
   **–í–∞–∂–Ω–æ**: –ò–º—è —Ñ–∞–π–ª–∞ –î–û–õ–ñ–ù–û –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å –Ω–æ–º–µ—Ä–∞:
   - ‚úÖ `12345_title.mp4`
   - ‚úÖ `67890_–º–æ—ë_–≤–∏–¥–µ–æ.mov`
   - ‚ùå `video.mp4` (–Ω–µ—Ç –Ω–æ–º–µ—Ä–∞ –≤ –Ω–∞—á–∞–ª–µ!)

4. **–ù–∞–∂–º–∏ Save**

   –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:
   - –§–∞–π–ª –∑–∞–≥—Ä—É–∑–∏—Ç—Å—è –≤ –≤—ã–±—Ä–∞–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑–≤–ª–µ–∫—É—Ç—Å—è –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ (duration, codec, resolution, etc.)
   - –†–∞—Å—Å—á–∏—Ç–∞–µ—Ç—Å—è checksum
   - –°–æ–∑–¥–∞—Å—Ç—Å—è –∑–∞–ø–∏—Å—å VideoFile —Å –Ω–æ–º–µ—Ä–æ–º –∏–∑ –∏–º–µ–Ω–∏ —Ñ–∞–π–ª–∞

---

### –°–ø–æ—Å–æ–± 2: –£–∫–∞–∑–∞–Ω–∏–µ –ø—É—Ç–∏ –∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É —Ñ–∞–π–ª—É

–ï—Å–ª–∏ —Ñ–∞–π–ª —É–∂–µ –µ—Å—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –≤ —Å–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º NAS:

1. **–û—Ç–∫—Ä–æ–π**: http://localhost:8000/admin/media_files/videofile/add/

2. **–í—ã–±–µ—Ä–∏ Storage Location**

3. **–£–∫–∞–∂–∏ –ø–æ–ª–Ω—ã–π –ø—É—Ç—å**:
   ```
   Or specify file path: /mnt/nas/archive/12345_title.mp4
   ```
   
   **–í–∞–∂–Ω–æ**:
   - –ü—É—Ç—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –í–ù–£–¢–†–ò –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ Storage Location
   - –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ Storage Location = `/mnt/nas/archive/`
   - –¢–æ –ø—É—Ç—å –º–æ–∂–µ—Ç –±—ã—Ç—å `/mnt/nas/archive/12345_title.mp4`

4. **–ù–∞–∂–º–∏ Save**

   –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç:
   - Django –ø—Ä–æ–≤–µ—Ä–∏—Ç —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
   - –ò–∑–≤–ª–µ—á–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
   - –†–∞—Å—Å—á–∏—Ç–∞–µ—Ç checksum
   - –°–æ–∑–¥–∞—Å—Ç VideoFile –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è —Ñ–∞–π–ª–∞

---

## –ü—Ä–æ—Å–º–æ—Ç—Ä –≤ License

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ:

1. –û—Ç–∫—Ä–æ–π –ª–∏—Ü–µ–Ω–∑–∏—é —Å —Ç–µ–º –∂–µ –Ω–æ–º–µ—Ä–æ–º:
   ```
   http://localhost:8000/admin/licenses/license/–ù–û–ú–ï–†/change/
   ```

2. –†–∞–∑–≤–µ—Ä–Ω–∏ —Å–µ–∫—Ü–∏—é **"Status & Metadata"**

3. –£–≤–∏–¥–∏—à—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∏–¥–µ–æ:
   ```
   Video File:
   üé¨ 12345_title.mp4
   00:25:30 ‚Ä¢ 1920x1080 ‚Ä¢ 1.2 GB
   ‚úì Available ‚Ä¢ NAS Archive
   ```

4. –ö–ª–∏–∫–Ω–∏ –Ω–∞ –∏–º—è —Ñ–∞–π–ª–∞ —á—Ç–æ–±—ã –æ—Ç–∫—Ä—ã—Ç—å VideoFile

---

## –ú–∞—Å—Å–æ–≤–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π –∫–æ–º–∞–Ω–¥—É —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è:

```bash
# Development (Docker)
docker-compose exec web python manage.py scan_video_storage

# Production (Debian)
cd /opt/ok-tools && python manage.py scan_video_storage
```

–ö–æ–º–∞–Ω–¥–∞:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞–π–¥–µ—Ç –≤—Å–µ –≤–∏–¥–µ–æ—Ñ–∞–π–ª—ã –≤ Storage Locations
- –ò–∑–≤–ª–µ—á–µ—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ
- –°–æ–∑–¥–∞—Å—Ç VideoFile –∑–∞–ø–∏—Å–∏
- –ù–∞–º–Ω–æ–≥–æ –±—ã—Å—Ç—Ä–µ–µ —á–µ–º —Ä—É—á–Ω–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ!

---

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –∏–º–µ–Ω–∞–º —Ñ–∞–π–ª–æ–≤

### ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

```
–ù–û–ú–ï–†_–Ω–∞–∑–≤–∞–Ω–∏–µ.—Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

–ü—Ä–∏–º–µ—Ä—ã:
12345_title.mp4
67890_–º–æ—ë-–≤–∏–¥–µ–æ.mov
99999_test_file.mpeg
1_simple.mpg
```

### ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç:

```
video.mp4                  (–Ω–µ—Ç –Ω–æ–º–µ—Ä–∞)
title_12345.mp4           (–Ω–æ–º–µ—Ä –Ω–µ –≤ –Ω–∞—á–∞–ª–µ)
abc12345_video.mov        (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å –±—É–∫–≤)
```

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:

- `.mp4` - MP4 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- `.mov` - QuickTime
- `.mpeg` - MPEG
- `.mpg` - MPEG

---

## Troubleshooting

### ‚ùå "Filename must start with a number"

**–†–µ—à–µ–Ω–∏–µ**: –ü–µ—Ä–µ–∏–º–µ–Ω—É–π —Ñ–∞–π–ª —á—Ç–æ–±—ã –æ–Ω –Ω–∞—á–∏–Ω–∞–ª—Å—è —Å –Ω–æ–º–µ—Ä–∞:
```bash
# –°—Ç–∞—Ä–æ–µ –∏–º—è
video.mp4

# –ù–æ–≤–æ–µ –∏–º—è
12345_video.mp4
```

### ‚ùå "File already exists"

**–†–µ—à–µ–Ω–∏–µ**: 
1. –§–∞–π–ª —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ –µ—Å—Ç—å –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
2. –õ–∏–±–æ –ø–µ—Ä–µ–∏–º–µ–Ω—É–π —Ñ–∞–π–ª
3. –õ–∏–±–æ –ø—Ä–æ–≤–µ—Ä—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π VideoFile

### ‚ùå "File does not exist"

–ï—Å–ª–∏ —É–∫–∞–∑—ã–≤–∞–µ—à—å –ø—É—Ç—å –≤—Ä—É—á–Ω—É—é:
```bash
# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ —Ñ–∞–π–ª —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
docker-compose exec web ls -la /mnt/nas/archive/12345_title.mp4

# –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –ø—É—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
docker-compose exec web ls -la /mnt/nas/archive/
```

### ‚ùå "File must be within storage location"

–ï—Å–ª–∏ Storage Location = `/mnt/nas/archive/`
–¢–æ –ø—É—Ç—å –¥–æ–ª–∂–µ–Ω –Ω–∞—á–∏–Ω–∞—Ç—å—Å—è —Å `/mnt/nas/archive/`

**–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ**: `/mnt/nas/playout/12345_title.mp4`
**–ü—Ä–∞–≤–∏–ª—å–Ω–æ**: `/mnt/nas/archive/12345_title.mp4`

---

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–∞–π–ª–∞

1. –£ —Ç–µ–±—è –µ—Å—Ç—å —Ñ–∞–π–ª `12345_–Ω–æ–≤—ã–π-–≤—ã–ø—É—Å–∫.mp4` –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
2. –û—Ç–∫—Ä–æ–π http://localhost:8000/admin/media_files/videofile/add/
3. Storage location: `NAS Archive`
4. Upload Video File: –≤—ã–±–µ—Ä–∏ —Ñ–∞–π–ª
5. Save
6. –ì–æ—Ç–æ–≤–æ! –í–∏–¥–µ–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ `/mnt/nas/archive/12345_–Ω–æ–≤—ã–π-–≤—ã–ø—É—Å–∫.mp4`

### –ü—Ä–∏–º–µ—Ä 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ —Ñ–∞–π–ª–∞

1. –§–∞–π–ª —É–∂–µ –ª–µ–∂–∏—Ç –Ω–∞ NAS: `/mnt/nas/archive/67890_—Å—Ç–∞—Ä—ã–π-–≤—ã–ø—É—Å–∫.mp4`
2. –û—Ç–∫—Ä–æ–π http://localhost:8000/admin/media_files/videofile/add/
3. Storage location: `NAS Archive`
4. Or specify file path: `/mnt/nas/archive/67890_—Å—Ç–∞—Ä—ã–π-–≤—ã–ø—É—Å–∫.mp4`
5. Save
6. –ì–æ—Ç–æ–≤–æ! VideoFile —Å–æ–∑–¥–∞–Ω –±–µ–∑ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –≤–∏–¥–µ–æ –ø–æ—è–≤–∏–ª–æ—Å—å –≤ License

1. –î–æ–±–∞–≤–∏–ª VideoFile #12345
2. –û—Ç–∫—Ä–æ–π License #12345
3. –†–∞–∑–≤–µ—Ä–Ω–∏ "Status & Metadata"
4. –í–∏–¥–∏—à—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –≤–∏–¥–µ–æ
5. –ö–ª–∏–∫–∞–µ—à—å –Ω–∞ –∏–º—è —Ñ–∞–π–ª–∞
6. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è VideoFile —Å player'–æ–º
7. –ú–æ–∂–µ—à—å –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–∏–¥–µ–æ –ø—Ä—è–º–æ –≤ –∞–¥–º–∏–Ω–∫–µ!

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è –µ–¥–∏–Ω–∏—á–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤:
‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É** - –ø—Ä–æ—Å—Ç–æ–π –∏ —É–¥–æ–±–Ω—ã–π —Å–ø–æ—Å–æ–±

### –î–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤:
‚úÖ **–ö–æ–º–∞–Ω–¥–∞ scan_video_storage** - –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ

### –î–ª—è —Ñ–∞–π–ª–æ–≤ —É–∂–µ –Ω–∞ NAS:
‚úÖ **–£–∫–∞–∑–∞–Ω–∏–µ –ø—É—Ç–∏** - –Ω–µ –Ω—É–∂–Ω–æ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª

---

## –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–≤—è–∑—å —Å License

–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è VideoFile –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:

1. Django –∏—â–µ—Ç License —Å —Ç–∞–∫–∏–º –∂–µ –Ω–æ–º–µ—Ä–æ–º
2. –ï—Å–ª–∏ –Ω–∞—Ö–æ–¥–∏—Ç - —Å–≤—è–∑—ã–≤–∞–µ—Ç –∏—Ö
3. –í License –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–∏–¥–µ–æ
4. –í VideoFile –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Å—Å—ã–ª–∫–∞ –Ω–∞ License

–≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –±–ª–∞–≥–æ–¥–∞—Ä—è –º–µ—Ç–æ–¥—É `get_video_file()` –≤ –º–æ–¥–µ–ª–∏ License.

